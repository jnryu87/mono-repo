{{- if .Values.ingress.enabled -}}
{{- $fullName := include "angular-app.fullname" . -}}
{{- $svcPort := .Values.service.port -}}
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: {{ $fullName }}
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /$2
spec:
  # ingressClassName: nginx-example
  # defaultBackend:
  #   service:
  #     name: {{ $fullName }}
  #     port:
  #       number: {{ $svcPort }}
  # rules:
  #   {{- range .Values.ingress.hosts }}
  #   - host: {{ .host | quote }}
  #     http:
  #       paths:
  #         - path: /
  #           pathType: Prefix
  #           backend:
  #             service:
  #               name: {{ $fullName }}
  #               port:
  #                 number: {{ $svcPort }}
  #   {{- end }}
  rules:
    - http:
        paths:
          - path: /angular(/|$)(.*)
            pathType: Prefix
            backend:
              service:
                name: {{ $fullName }}
                port:
                  number: {{ $svcPort }}
{{- end }}
